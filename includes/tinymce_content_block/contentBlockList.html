<style type="text/css">

	.hide {
		display: none;
	}

	.show {
		display: list-item;
	}
	
	#cb_list {
		padding: 15px;
	}

	#cb_list_search {
		display: block;
		height: 40px;
		width: 100%;
		font-size: 16px;
	}	

	#cb_list_items {
		list-style: none;
		max-height: 300px;		
		padding: 0;
		border: 1px solid #cdcdcd;
		overflow: scroll;
		font-family: 'system-ui';
	}

	.cb_list_item {
		padding: 12px 5px;
		cursor: pointer;
	}

	.highlight {
		background-color: #0073aa;
		color: #fff;
	}

</style>


<div id='cb_list'>
	<input id='cb_list_search' type='text' value='' placeholder='Search'>
	<div id='items_wrapper'></div>	
</div>


<script>
	
	var args = top.tinymce.activeEditor.windowManager.getParams();	
	var listDiv = document.getElementById('items_wrapper');
	var search = document.getElementById('cb_list_search');
	var ul = document.createElement('ul');
	ul.id = 'cb_list_items';

	var selectedBlocks = parent.tinymce.activeEditor.selectedBlocks = [];
	listDiv.appendChild(ul);


	args.listItems.map(function(item){	
		var li = document.createElement('li');		
		li.innerHTML = item.text;
		li.classList.add('cb_list_item');
		li.dataset.shortcode = item.value;

		ul.appendChild(li);

		li.addEventListener('click', function() {
			if( this.classList.contains('highlight') ) {
				this.classList.remove('highlight');				
								
				var blockIndex = selectedBlocks.indexOf(this.dataset.shortcode);
				selectedBlocks.splice(blockIndex, 1);

				console.log(selectedBlocks);
			} else {
				this.classList.add('highlight');											
				selectedBlocks.push(this.dataset.shortcode);
				
				console.log(selectedBlocks);
			}			
		});

		
	});

	search.addEventListener('input', function(e){
		console.log(e.target.value);		
		
		var blockList = document.querySelectorAll('.cb_list_item');
		for( var i = 0; i < blockList.length; i++ ) {
			console.log(blockList[i]);

			
		}


	});


	
</script>